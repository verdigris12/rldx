# Path to the directory containing your vCard files.
vdir = "~/.contacts"
db_path = "~/.local/share/rldx/index.db"

# =============================================================================
# Top Bar Buttons
# =============================================================================
# Map function keys (F1-F12) to actions displayed in the header bar.
# Supported actions: help, edit, refresh, share
# - help: Open help modal (key bindings reference)
# - edit: Open external vCard editor (not yet implemented)
# - refresh: Force full reindex of all contacts
# - share: Show QR code for current contact (mobile-ready)

[top_bar]
F1 = "help"
F2 = "edit"
F3 = "refresh"
F4 = "share"

# Optional: override which fields appear in the first pane.
# fields_first_pane = ["fname", "mname", "lname", "alias", "phone", "email"]

# Optional: default region to use when normalizing phone numbers (ISO 3166-1 alpha-2).
# phone_region = "US"

# =============================================================================
# Key Bindings
# =============================================================================
# Keys are organized by context. Each action can have multiple bindings.
# Supported key names:
#   - Single characters: "a", "A", "/", "?", etc. (case-sensitive: "m" != "M")
#   - Special keys: "Enter", "Escape", "Tab", "Backtab", "Space", "Backspace"
#   - Arrow keys: "Up", "Down", "Left", "Right"
#   - Navigation: "PageUp", "PageDown", "Home", "End"
#   - Function keys: "F1" through "F12"
#
# Note: Single-character bindings are CASE-SENSITIVE ("M" requires Shift).
# Note: Ctrl/Alt/Super modifiers are NOT supported.
# Key bindings within each context must not collide.

[keys.global]
# Keys that work in most contexts
quit = ["q"]
search = ["/"]
help = ["F1", "?"]

[keys.search_input]
# Keys when typing in the search box
cancel = ["Escape"]              # Move focus to results
confirm = ["Enter"]              # Select contact and close search

[keys.search_results]
# Keys when navigating search results
cancel = ["Escape"]              # Close search
confirm = ["Enter"]              # Select contact and close search
next = ["j", "Down", "Tab"]      # Next result
prev = ["k", "Up", "Backtab"]    # Previous result
page_down = ["PageDown"]         # Jump down 5
page_up = ["PageUp"]             # Jump up 5
mark = ["Space"]                 # Mark/unmark contact for merge
merge = ["m"]                    # Merge marked contacts
toggle_marked = ["M"]            # Toggle marked-only view

[keys.navigation]
# Keys when navigating card/detail panes (search closed)
next = ["j", "Down", "Tab"]      # Next field
prev = ["k", "Up", "Backtab"]    # Previous field
tab_next = ["l", "Right"]        # Next pane/tab
tab_prev = ["h", "Left"]         # Previous pane/tab
edit = ["e"]                     # Edit current field
copy = ["y", "Space"]            # Copy current field value
confirm = ["Enter"]              # Open multivalue modal (if applicable)
add_alias = ["a"]                # Add alias (when ALIAS field focused)
photo_fetch = ["i"]              # Fetch photo from URL (not implemented)
lang_cycle = ["L"]               # Cycle display language (not implemented)

[keys.modal]
# Keys in modal dialogs (multivalue, confirm, alias)
cancel = ["Escape", "q"]         # Close modal
confirm = ["Enter", "y"]         # Confirm action
next = ["j", "Down", "Tab"]      # Next item
prev = ["k", "Up", "Backtab"]    # Previous item
edit = ["e"]                     # Edit selected item
copy = ["Space"]                 # Copy and close
set_default = ["d"]              # Set as default value

[keys.editor]
# Keys when editing a field inline
cancel = ["Escape"]              # Cancel edit
confirm = ["Enter"]              # Save edit

# =============================================================================
# UI Configuration
# =============================================================================

[ui.colors]
# RGB values for the UI theme.
border = [255, 140, 0]
selection_bg = [255, 140, 0]
selection_fg = [0, 0, 0]
separator = [255, 140, 0]
status_fg = [255, 140, 0]
status_bg = [0, 0, 0]

[ui.icons]
address_book = "@"
contact = "üë§ "
organization = "üè¢ "

[ui.pane.image]
# Width of the image pane in characters.
width = 40
# Height of the image pane in rows.
height = 12

# =============================================================================
# Commands
# =============================================================================

[commands]
# Program that receives copied values on stdin.
# Examples:
#   copy = ["wl-copy"]                           # Wayland
#   copy = ["xclip", "-selection", "clipboard"]  # X11
#   copy = ["pbcopy"]                            # macOS
copy = ["xclip", "-selection", "clipboard"]

# =============================================================================
# Maildir Import Filters
# =============================================================================
# Filters for the `rldx import --format maildir` command.
# These patterns are used to skip automated/noreply addresses.

[maildir_import]
# Local part patterns to skip (case-insensitive, substring match).
# Emails where the local part (before @) contains any of these are skipped.
skip_local_patterns = [
    "noreply",
    "no-reply",
    "no_reply",
    "donotreply",
    "do-not-reply",
    "do_not_reply",
    "notifications",
    "notification",
    "mailer-daemon",
    "postmaster",
    "bounce",
    "auto-reply",
    "autoreply",
    "automated"
]

# Domain patterns to skip (case-insensitive).
# Supports wildcards: "*.example.com" matches both "example.com" and "sub.example.com".
skip_domains = [
    "facebookmail.com",
    "*.facebookmail.com",
    "linkedin.com",
    "*.linkedin.com",
    "amazonses.com",
    "*.amazonses.com",
    "sendgrid.net",
    "*.sendgrid.net",
    "mailchimp.com",
    "*.mailchimp.com",
    "mailgun.org",
    "*.mailgun.org",
]

# SimHash Hamming distance threshold for automerge candidate filtering.
# Lower = stricter (fewer candidates), higher = more lenient.
# Candidates within this Hamming distance are verified with Jaro-Winkler.
# Default: 4 (good for ~0.98 Jaro-Winkler threshold)
simhash_threshold = 4

# Minimum name length for automerge consideration.
# Names shorter than this are not considered for matching.
# Default: 8
min_name_length = 8

# Minimum number of spaces required in FN for automerge.
# This ensures FN matches have at least first + last name.
# Nicknames are not subject to this requirement.
# Default: 1
min_fn_spaces = 1

# Shannon entropy threshold for email local part filtering.
# Emails with entropy above this are considered random/UUID-like and skipped.
# Entropy measures randomness: "john.doe" ~2.5, "a8f3d2e1-4b5c" ~3.8
# Default: 3.5
email_entropy_threshold = 3.5

# =============================================================================
# Encryption (required)
# =============================================================================
# All vCard files and the index database are encrypted.
# Run 'rldx init' to set up encryption automatically.
#
# Encryption types:
#   gpg  - GPG encryption (uses gpg-agent, files stored as .vcf.gpg)
#   age  - Age encryption (modern alternative, files stored as .vcf.age)
#
# Features:
#   - All vCard files are encrypted with the specified key
#   - The SQLite index database is encrypted with SQLCipher
#   - Decryption happens transparently when reading contacts
#   - Hard fail on decryption errors (no silent fallback)

[encryption]
# Encryption backend: "gpg" or "age" (required)
type = "age"

# GPG Configuration (required if type = "gpg")
# The key ID to use for encryption. Can be:
#   - Short key ID: "0x1234ABCD"
#   - Long key ID: "0x1234ABCD5678EF90"
#   - Fingerprint: "1234ABCD5678EF901234ABCD5678EF901234ABCD"
#   - Email: "user@example.com"
# gpg_key_id = "0x1234ABCD"

# Age Configuration (required if type = "age")
# Path to the age identity file (private key)
age_identity = "~/.config/rldx/age-identity.txt"
# Age recipient public key (starts with "age1...")
age_recipient = "age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p"

# =============================================================================
# Sync Configuration (optional)
# =============================================================================
# Global settings for CardDAV synchronization.

[sync]
# Default conflict resolution when local and remote both changed.
# Values: "ours" (local wins) or "theirs" (remote wins)
# Default: "theirs"
conflict_prefer = "theirs"

# =============================================================================
# Remote Servers (optional)
# =============================================================================
# Configure CardDAV servers to sync with.
# Run 'rldx remote add' to add remotes interactively.
#
# Example:
#
# [[remotes]]
# name = "nextcloud"                                        # Unique name
# type = "carddav"                                          # Remote type
# url = "https://cloud.example.com/remote.php/dav"          # Server URL
# username = "user"                                         # Username
# address_book = "contacts"                                 # Address book name
# password_cmd = "pass show cloud/nextcloud"                # Command to get password
# # password_file = "~/.secrets/nextcloud"                  # Or file path
# # password = "secret"                                     # Or plaintext (not recommended)
# conflict_prefer = "ours"                                  # Override global setting
# local_book = "nextcloud"                                  # Subdirectory in vdir
#
# [[remotes]]
# name = "fastmail"
# type = "carddav"
# url = "https://carddav.fastmail.com"
# username = "user@fastmail.com"
# address_book = "Default"
# password_cmd = "pass show email/fastmail"
